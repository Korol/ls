$(document).ready(function(){var e=20,t=1,a=1;$.Employees={Init:function(){this.InitActions(),this.InitDynamicData(),this.InitTemplate()},InitActions:function(){$(document).on("click",".action-blocked-employee",function(e){var t=$(e.target).closest(".employee-wrap"),a=t.attr("id-employee"),o=$(e.target).prop("checked");bootbox.confirm((o?"Заблокировать":"Разблокировать")+" сотрудника №<strong>"+a+"</strong>?",function(t){t?$.Employees.SaveBlock(a,o):$(e.target).prop("checked",!o)})}),$(document).on("click","#EmployeesStatus input:radio",function(e){$("#CurrentPage").val(1),$.Employees.ReloadEmployeesList()}),$(document).on("click","#UserRole input:radio",function(e){$("#CurrentPage").val(1),$.Employees.ReloadEmployeesList()}),$(document).on("click","#FilterSite input:radio",function(e){$("#CurrentPage").val(1),$.Employees.ReloadEmployeesList()}),$(document).on("keyup",".filter-input",function(e){delay(function(){$("#CurrentPage").val(1),$.Employees.ReloadEmployeesList()},500)}),$(document).on("keyup","#CurrentPage",function(e){delay(function(){$.Employees.ReloadEmployeesList()},500)}),$(".assol-pagination-arrs .next").click(function(){$("#CurrentPage").val((parseInt($("#CurrentPage").val())||0)+1),$.Employees.ReloadEmployeesList()}),$(".assol-pagination-arrs .prev").click(function(){$("#CurrentPage").val((parseInt($("#CurrentPage").val())||0)-1),$.Employees.ReloadEmployeesList()})},InitDynamicData:function(){this.ReloadEmployeesList()},InitTemplate:function(){$("#employeeTemplate").template("employeeTemplate")},ReloadEmployeesList:function(){this.ReloadData("#employees","employeeTemplate")},ReloadData:function(o,n){function l(l){l.status?(l.data.records&&($(o).empty(),$.tmpl(n,l.data.records).appendTo(o)),t=Math.ceil(l.data.count/e)||1,a=parseInt($("#CurrentPage").val())||1,a>t&&$("#CurrentPage").val(1),$("#CountPage").html(t)):showErrorAlert(l.message)}$(o).html('<span class="load-inform">Загрузка данных...</span>'),a=parseInt($("#CurrentPage").val())||0,a<1&&$("#CurrentPage").val(1),a>t&&$("#CurrentPage").val(t);var i={Status:$("#EmployeesStatus").find("input:radio:checked").val(),FIO:$("#FilterFIO").val(),UserRole:$("#UserRole").find("input:radio:checked").val(),Site:$("#FilterSite").find("input:radio:checked").val(),Limit:e,Offset:(($("#CurrentPage").val()||1)-1)*e},s=BaseUrl+"employee/data";$.post(s,{data:i},l,"json")},SaveBlock:function(e,t){function a(e){e.status?$.Employees.ReloadEmployeesList():showErrorAlert(e.message)}var o={IsBlocked:t?1:0};$.post(BaseUrl+"employee/"+e+"/update",{data:o},a,"json")}},$.Employees.Init()});