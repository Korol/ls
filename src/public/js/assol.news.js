$(document).ready(function(){var c=1,d=1;$.News={Init:function(){this.InitActions();this.InitDynamicData();this.InitTemplate()},InitActions:function(){$(document).on("click",".action-remove-news",function(a){$.News.RemoveNewsRecord($(a.target).closest("button").attr("record"))});$(document).on("click","#newsCategory input:radio",function(a){var b=$("#newsCustomer input:radio:checked").val();$.News.ReloadNewsList($(a.target).val(),b);$.News.ReloadCustomerList($(a.target).val())});$(document).on("click",
"#newsCustomer input:radio",function(a){var b=$("#newsCategory input:radio:checked").val();$.News.ReloadNewsList(b,$(a.target).val())});$(".assol-pagination-arrs .next").click(function(){$("#CurrentPage").val((parseInt($("#CurrentPage").val())||0)+1);$.News.ReloadNewsList()});$(".assol-pagination-arrs .prev").click(function(){$("#CurrentPage").val((parseInt($("#CurrentPage").val())||0)-1);$.News.ReloadNewsList()});$(document).on("keyup",".filter-input",function(a){delay(function(){$.News.ReloadNewsList()},
500)})},InitDynamicData:function(){this.ReloadNewsList()},InitTemplate:function(){$("#newsTemplate").template("newsTemplate")},ReloadNewsList:function(a,b){a=a||$("#newsCategory input:radio:checked").val();b=b||$("#newsCustomer input:radio:checked").val();this.ReloadData("#news","newsTemplate",a,b)},ReloadCustomerList:function(a){a=a||$("#newsCategory input:radio:checked").val();$.post(BaseUrl+"news/customerlist",{siteID:a||0},function(a){""!==a&&$("#newsCustomer > ul.dropdown-menu").html("").append(a)},
"html")},ReloadData:function(a,b,f,g){$(a).html("\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0434\u0430\u043d\u043d\u044b\u0445...");d=parseInt($("#CurrentPage").val())||0;1>d&&$("#CurrentPage").val(1);d>c&&$("#CurrentPage").val(c);f={category:f||0,customer:g||0,Limit:10,Offset:10*(($("#CurrentPage").val()||1)-1)};$.post(BaseUrl+"news/data",{data:f},function(e){e.status?(e.records&&($(a).empty(),$.tmpl(b,e.records).appendTo(a)),c=Math.ceil(e.count/10),d=parseInt($("#CurrentPage").val())||1,
d>c&&$("#CurrentPage").val(1),$("#CountPage").html(c)):showErrorAlert(e.message)},"json")},RemoveNewsRecord:function(a){$.post(BaseUrl+"news/"+a+"/remove",{},function(a){a.status&&$.News.ReloadNewsList()},"json")}};$.News.Init()});
