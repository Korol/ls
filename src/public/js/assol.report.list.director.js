$(document).ready(function(){"use strict";function e(){return R}function a(){var e=[{Level:r.Level,Name:r.Name},{Level:o.Level,Name:o.Name}];switch(d){case s.Level:e.push({Name:s.Name});break;case L.Level:e.push({Name:L.Name});break;case v.Level:e.push({Name:v.Name});break;case i.Level:e.push({Name:i.Name})}return e[e.length-1].IsLast=!0,e}function t(){var e=[{Level:n.Level,Name:n.Name}];switch(d){case m.Level:e.push({Name:m.Name,IsLast:!0});break;case N.Level:e.push({Name:N.Name,IsLast:!0});break;case p.Level:e.push({Name:p.Name,IsLast:!0});break;case c.Level:e.push({Name:c.Name,IsLast:!0})}return e}const l={Level:0},r={Level:1,Name:"Индивидуальные"},o={Level:2,Name:e},s={Level:21,Name:"Ежедневный отчет"},v={Level:22,Name:"Отчет по переписке"},L={Level:23,Name:"Отчет по рассылке"},i={Level:24,Name:"Отчет по зарплате"},n={Level:3,Name:"Общие"},m={Level:31,Name:"Сводная зарплатная таблица"},c={Level:32,Name:"Общая з/п таблица"},p={Level:33,Name:"Общая таблица по клиентам"},N={Level:34,Name:"Сводная таблица распределения"};var d=l.Level,R="",u=0,I={main:{data:[{Level:r.Level,Name:r.Name.toUpperCase()},{Level:n.Level,Name:n.Name.toUpperCase()}]},general:{bread:[{Name:n.Name,IsLast:!0}],data:[{Level:m.Level,Name:m.Name,IsDoc:!0},{Level:c.Level,Name:c.Name,IsDoc:!0},{Level:p.Level,Name:p.Name,IsDoc:!0},{Level:N.Level,Name:N.Name,IsDoc:!0}]},individual:{bread:a,data:[{Level:s.Level,Name:s.Name,IsDoc:!0},{Level:v.Level,Name:v.Name,IsDoc:!0},{Level:L.Level,Name:L.Name,IsDoc:!0},{Level:i.Level,Name:i.Name,IsDoc:!0}]}};$.ReportListDirector={Init:function(){this.InitActions(),this.InitTemplate(),this.InitDynamicData()},InitActions:function(){$(document).on("click",".report-folder>a, .report-bread",function(e){var a=$(e.target).closest("[level]");if(d=parseInt(a.attr("level")),d==o.Level){var t=a.find(".folder-name").html();t&&(R=t);var l=a.attr("id-employee");l&&(u=l)}$.ReportListDirector.ReloadReportList()})},InitDynamicData:function(){this.ReloadReportList()},InitTemplate:function(){$("#reportsTemplate").template("reportsTemplate")},ReloadReportList:function(){function e(e){$("#reports").empty(),$.tmpl("reportsTemplate",e).appendTo("#reports")}function R(a){if(a.status){if(a.records){var t={bread:[{Level:r.Level,Name:r.Name,IsLast:!0}],data:a.records};e(t)}}else showErrorAlert(a.message)}switch($("#reports").html("Загрузка данных..."),d){case l.Level:e(I.main);break;case r.Level:$.post(BaseUrl+"reports/data",{},R,"json");break;case n.Level:e(I.general);break;case o.Level:e(I.individual);break;case s.Level:case L.Level:case v.Level:case i.Level:e({bread:a()});break;case m.Level:case N.Level:case p.Level:case c.Level:e({bread:t()});break;default:alert("Ошибка загрузки данных")}$.ReportListDirector.ShowReport(d)},ShowReport:function(e){switch($("#ReportIndividualDaily").toggle(e==s.Level),$("#ReportIndividualMailing").toggle(e==L.Level),$("#ReportIndividualCorrespondence").toggle(e==v.Level),$("#ReportIndividualSalary").toggle(e==i.Level),$("#ReportOverallSalary").toggle(e==m.Level),$("#ReportOverallAllocation").toggle(e==N.Level),$("#ReportGeneralOfCustomers").toggle(e==p.Level),$("#ReportGeneralSalary").toggle(e==c.Level),e){case s.Level:$.ReportTranslate.setEmployee(u),$.ReportTranslate.ReloadReportDailyMeta();break;case L.Level:$.ReportTranslate.setEmployee(u),$.ReportTranslate.ReloadReportMailing();break;case v.Level:$.ReportTranslate.setEmployee(u),$.ReportTranslate.ReloadReportCorrespondence();break;case i.Level:$.ReportTranslate.setEmployee(u),$.ReportTranslate.ReloadReportSalary();break;case m.Level:$("#overlaySalarySite").find("input:first").click();break;case N.Level:$("#overallAllocationSite").find("input:first").click();break;case p.Level:$.ReportDirector.ReloadReportGeneralOfCustomers();break;case c.Level:$.ReportDirector.ReloadReportGeneralSalary()}}},$.ReportListDirector.Init()});